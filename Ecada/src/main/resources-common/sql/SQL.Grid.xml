<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
PUBLIC "-//ibatis.apache.org//DTD Mapper 3.0//EN"
"http://ibatis.apache.org/dtd/ibatis-3-mapper.dtd">

<mapper namespace="com.tj.dao.GridDao">
	<select id="gList" parameterType="map" resultType="map">
	select	board_seq as boardSeq,
			member_idx as memberIdx,
			member_id as memberId,
			member_nick as memberNick,
			title,
			content,
			has_file,
			hits,
			date_format(create_date, '%Y-%m-%d') as createDate,
			update_date as updateDate
	from board
	where type_seq = 3
		<if test="searchType != null and searchType == 1">
		and (title like concat('%', #{searchText}, '%') or content like concat('%', #{searchText}, '%'))
		</if>
		<if test="searchType != null and searchType == 2">
		and title like concat('%', #{searchText}, '%')
		</if>
		<if test="searchType != null and searchType == 3">
		and content like concat('%', #{searchText}, '%')
		</if>
	order by ${sidx} ${sord}
	limit ${startIdx}, ${rows}
	</select>
	
	<select id="getTotalCount" parameterType="java.util.HashMap" resultType="int">
	select count(board_seq) from board
	where type_seq = 2
		<if test="searchType != null and searchType == 1">
		and (title like concat('%', #{searchText}, '%') or content like concat('%', #{searchText}, '%'))
		</if>
		<if test="searchType != null and searchType == 2">
		and title like concat('%', #{searchText}, '%')
		</if>
		<if test="searchType != null and searchType == 3">
		and content like concat('%', #{searchText}, '%')
		</if>
	</select>
</mapper>